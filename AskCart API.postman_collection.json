{
	"info": {
		"_postman_id": "c3f5a97a-922b-4d22-b728-18664ef5b137",
		"name": "AskCart API - Complete Test Suite",
		"description": "# AskCart API Test Suite\n\n## Quick Start Workflow\n1. **Register** a new user\n2. **Login** → JWT automatically saved to environment\n3. **Create Product** (uses saved JWT from Authorization header)\n4. **Add to Cart** (uses saved JWT, no userId needed)\n5. **Create Order** (uses saved JWT, no UUID generation)\n6. **Chat with AI** (public, no auth needed)\n7. **Run Negative Tests** to verify security\n\n## Authentication\n- JWT stored in HTTP-only cookie `jwt`\n- Automatically extracted on login and saved to `jwt_token` variable\n- Added to `Authorization: Bearer {{jwt_token}}` header for protected endpoints\n- All cart/order operations use authenticated user context (no manual userId)\n\n## API Security\n**Public APIs (no auth required):**\n- GET /api/products (list)\n- GET /api/products/{id} (detail)\n- POST /api/ai/chat\n- POST /api/auth/register\n- POST /api/auth/login\n\n**Protected APIs (JWT required):**\n- POST/PUT/DELETE /api/products\n- All /api/cart/* endpoints\n- All /api/orders/* endpoints\n- POST /api/ai/ingest\n- POST /api/ai/query\n\n## Environment Variables\n- `baseUrl`: http://localhost:8000\n- `jwt_token`: Auto-populated on login\n- `productId`: Auto-populated on product creation",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "Auth",
			"description": "Authentication endpoints for user registration, login, and session management.",
			"item": [
				{
					"name": "Register",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Registration successful\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response has user data\", function () {",
									"    const jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('username');",
									"    pm.expect(jsonData).to.have.property('email');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"username\": \"testuser\",\n  \"email\": \"testuser@example.com\",\n  \"password\": \"test@123\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/api/auth/register",
							"host": ["{{baseUrl}}"],
							"path": ["api", "auth", "register"]
						},
						"description": "Register a new user account. Public endpoint."
					},
					"response": []
				},
				{
					"name": "Login",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// Extract JWT from cookie OR response body",
									"const token = pm.cookies.get(\"jwt\") || (pm.response.json().data && pm.response.json().data.token);",
									"",
									"if (token) {",
									"    pm.environment.set(\"jwt_token\", token);",
									"    console.log(\"✅ JWT saved to environment: \" + token.substring(0, 20) + \"...\");",
									"} else {",
									"    console.log(\"⚠️ No JWT token found in cookie or response\");",
									"}",
									"",
									"pm.test(\"Login successful\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"JWT token extracted\", function () {",
									"    pm.expect(token).to.not.be.undefined;",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"username\": \"testuser\",\n  \"password\": \"test@123\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/api/auth/login",
							"host": ["{{baseUrl}}"],
							"path": ["api", "auth", "login"]
						},
						"description": "Login and receive JWT in HTTP-only cookie. Token is automatically extracted and saved to environment variable."
					},
					"response": []
				},
				{
					"name": "Get Current User",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"User data retrieved\", function () {",
									"    pm.response.to.have.status(200);",
									"    const jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('username');",
									"    pm.expect(jsonData).to.have.property('email');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{jwt_token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/auth/me",
							"host": ["{{baseUrl}}"],
							"path": ["api", "auth", "me"]
						},
						"description": "Get current authenticated user's information. Requires JWT."
					},
					"response": []
				},
				{
					"name": "Refresh Token",
					"request": {
						"method": "POST",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/auth/refresh",
							"host": ["{{baseUrl}}"],
							"path": ["api", "auth", "refresh"]
						},
						"description": "Refresh the JWT token. Returns new token in cookie."
					},
					"response": []
				},
				{
					"name": "Logout",
					"request": {
						"method": "POST",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/auth/logout",
							"host": ["{{baseUrl}}"],
							"path": ["api", "auth", "logout"]
						},
						"description": "Logout and clear JWT cookie."
					},
					"response": []
				}
			]
		},
		{
			"name": "Products",
			"description": "Product management endpoints. GET operations are public, while CREATE/UPDATE/DELETE require authentication.",
			"item": [
				{
					"name": "Public",
					"description": "Public product endpoints (no authentication required)",
					"item": [
						{
							"name": "Get All Products",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test(\"Products retrieved\", function () {",
											"    pm.response.to.have.status(200);",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{baseUrl}}/api/products",
									"host": ["{{baseUrl}}"],
									"path": ["api", "products"]
								},
								"description": "Get all products. Public endpoint - no authentication required."
							},
							"response": []
						},
						{
							"name": "Get Product by ID",
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{baseUrl}}/api/products/{{productId}}",
									"host": ["{{baseUrl}}"],
									"path": ["api", "products", "{{productId}}"]
								},
								"description": "Get product details by ID. Public endpoint - no authentication required."
							},
							"response": []
						}
					]
				},
				{
					"name": "Protected",
					"description": "Protected product endpoints (authentication required)",
					"item": [
						{
							"name": "Create Product",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test(\"Product created\", function () {",
											"    pm.response.to.have.status(200);",
											"});",
											"",
											"const jsonData = pm.response.json();",
											"if (jsonData && jsonData.id) {",
											"    pm.environment.set(\"productId\", jsonData.id);",
											"    console.log(\"✅ Product ID saved: \" + jsonData.id);",
											"}"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{jwt_token}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"name\": \"Smart Watch Pro\",\n  \"description\": \"A high-end smart watch with AI features and health tracking.\",\n  \"sku\": \"SW-2025-PRO\",\n  \"price\": 299.99,\n  \"currency\": \"USD\",\n  \"stockQuantity\": 100,\n  \"categoryId\": \"electronics\"\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{baseUrl}}/api/products",
									"host": ["{{baseUrl}}"],
									"path": ["api", "products"]
								},
								"description": "Create a new product. **Requires JWT authentication.**"
							},
							"response": []
						},
						{
							"name": "Update Product",
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{jwt_token}}",
											"type": "string"
										}
									]
								},
								"method": "PUT",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"name\": \"Smart Watch Pro - Updated\",\n  \"description\": \"Updated description\",\n  \"price\": 279.99,\n  \"stockQuantity\": 150\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{baseUrl}}/api/products/{{productId}}",
									"host": ["{{baseUrl}}"],
									"path": ["api", "products", "{{productId}}"]
								},
								"description": "Update an existing product. **Requires JWT authentication.**"
							},
							"response": []
						},
						{
							"name": "Delete Product",
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{jwt_token}}",
											"type": "string"
										}
									]
								},
								"method": "DELETE",
								"header": [],
								"url": {
									"raw": "{{baseUrl}}/api/products/{{productId}}",
									"host": ["{{baseUrl}}"],
									"path": ["api", "products", "{{productId}}"]
								},
								"description": "Delete a product. **Requires JWT authentication.**"
							},
							"response": []
						}
					]
				}
			]
		},
		{
			"name": "Cart",
			"description": "Shopping cart management. All cart operations require authentication and automatically use the authenticated user's context.",
			"item": [
				{
					"name": "Get My Cart",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Cart retrieved\", function () {",
									"    pm.response.to.have.status(200);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{jwt_token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/cart",
							"host": ["{{baseUrl}}"],
							"path": ["api", "cart"]
						},
						"description": "Get current user's cart. **Requires JWT authentication.** User ID is automatically extracted from JWT."
					},
					"response": []
				},
				{
					"name": "Add Item to Cart",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Item added to cart\", function () {",
									"    pm.response.to.have.status(200);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{jwt_token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"productId\": \"{{productId}}\",\n  \"name\": \"Smart Watch Pro\",\n  \"price\": 299.99,\n  \"quantity\": 2\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/api/cart/items",
							"host": ["{{baseUrl}}"],
							"path": ["api", "cart", "items"]
						},
						"description": "Add item to current user's cart. **Requires JWT authentication.** No userId needed - automatically uses authenticated user."
					},
					"response": []
				},
				{
					"name": "Remove Item from Cart",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{jwt_token}}",
									"type": "string"
								}
							]
						},
						"method": "DELETE",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/cart/items/{{productId}}",
							"host": ["{{baseUrl}}"],
							"path": ["api", "cart", "items", "{{productId}}"]
						},
						"description": "Remove item from current user's cart. **Requires JWT authentication.**"
					},
					"response": []
				},
				{
					"name": "Clear Cart",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{jwt_token}}",
									"type": "string"
								}
							]
						},
						"method": "DELETE",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/cart",
							"host": ["{{baseUrl}}"],
							"path": ["api", "cart"]
						},
						"description": "Clear all items from current user's cart. **Requires JWT authentication.**"
					},
					"response": []
				}
			]
		},
		{
			"name": "Orders",
			"description": "Order management. All order operations require authentication and automatically use the authenticated user's context.",
			"item": [
				{
					"name": "Create Order",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Order created successfully\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Order has ID\", function () {",
									"    const jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('id');",
									"    pm.expect(jsonData).to.have.property('totalAmount');",
									"    pm.expect(jsonData).to.have.property('status');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{jwt_token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"items\": [\n    {\n      \"productId\": \"{{productId}}\",\n      \"productName\": \"Smart Watch Pro\",\n      \"unitPrice\": 299.99,\n      \"quantity\": 1\n    }\n  ]\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/api/orders",
							"host": ["{{baseUrl}}"],
							"path": ["api", "orders"]
						},
						"description": "Create order for current user. **Requires JWT authentication.** userId is automatically extracted from JWT - no need to include in request body or generate UUID."
					},
					"response": []
				},
				{
					"name": "Get My Orders",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Orders retrieved\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response is array\", function () {",
									"    const jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.be.an('array');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{jwt_token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/orders",
							"host": ["{{baseUrl}}"],
							"path": ["api", "orders"]
						},
						"description": "Get all orders for current user. **Requires JWT authentication.** Returns order history for authenticated user."
					},
					"response": []
				}
			]
		},
		{
			"name": "AI",
			"description": "AI-powered product search and recommendations.",
			"item": [
				{
					"name": "Chat with AI (Public)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"AI chat response received\", function () {",
									"    pm.response.to.have.status(200);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"query\": \"Do you have any smart watches? What are the best features?\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/api/ai/chat",
							"host": ["{{baseUrl}}"],
							"path": ["api", "ai", "chat"]
						},
						"description": "Chat with AI assistant about products. **Public endpoint - no authentication required.**"
					},
					"response": []
				},
				{
					"name": "Ingest Products (Protected)",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{jwt_token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/ai/ingest",
							"host": ["{{baseUrl}}"],
							"path": ["api", "ai", "ingest"]
						},
						"description": "Ingest products into AI vector database. **Requires JWT authentication.**"
					},
					"response": []
				},
				{
					"name": "Query Products (Protected)",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{jwt_token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"query\": \"smart watch\",\n  \"limit\": 10\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/api/ai/query",
							"host": ["{{baseUrl}}"],
							"path": ["api", "ai", "query"]
						},
						"description": "Query AI for product recommendations. **Requires JWT authentication.**"
					},
					"response": []
				}
			]
		},
		{
			"name": "Negative Tests",
			"description": "Security tests to verify that protected endpoints return 401 when accessed without authentication.",
			"item": [
				{
					"name": "Create Product Without Auth → 401",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Returns 401 Unauthorized\", function () {",
									"    pm.response.to.have.status(401);",
									"});",
									"",
									"console.log(\"✅ Security test passed: Protected endpoint blocked unauthenticated request\");"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"name\": \"Unauthorized Product\",\n  \"price\": 99.99\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/api/products",
							"host": ["{{baseUrl}}"],
							"path": ["api", "products"]
						},
						"description": "Attempt to create product without authentication. **Expected: 401 Unauthorized**"
					},
					"response": []
				},
				{
					"name": "Get Cart Without Auth → 401",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Returns 401 Unauthorized\", function () {",
									"    pm.response.to.have.status(401);",
									"});",
									"",
									"console.log(\"✅ Security test passed: Cart endpoint blocked unauthenticated request\");"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/cart",
							"host": ["{{baseUrl}}"],
							"path": ["api", "cart"]
						},
						"description": "Attempt to get cart without authentication. **Expected: 401 Unauthorized**"
					},
					"response": []
				},
				{
					"name": "Create Order Without Auth → 401",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Returns 401 Unauthorized\", function () {",
									"    pm.response.to.have.status(401);",
									"});",
									"",
									"console.log(\"✅ Security test passed: Order endpoint blocked unauthenticated request\");"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"items\": []\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/api/orders",
							"host": ["{{baseUrl}}"],
							"path": ["api", "orders"]
						},
						"description": "Attempt to create order without authentication. **Expected: 401 Unauthorized**"
					},
					"response": []
				},
				{
					"name": "Get Cart With Invalid Token → 401",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Returns 401 Unauthorized\", function () {",
									"    pm.response.to.have.status(401);",
									"});",
									"",
									"console.log(\"✅ Security test passed: Invalid token rejected\");"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "invalid.jwt.token",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/cart",
							"host": ["{{baseUrl}}"],
							"path": ["api", "cart"]
						},
						"description": "Attempt to get cart with invalid JWT. **Expected: 401 Unauthorized**"
					},
					"response": []
				}
			]
		}
	],
	"variable": [
		{
			"key": "baseUrl",
			"value": "http://localhost:8000",
			"type": "string"
		},
		{
			"key": "jwt_token",
			"value": "",
			"type": "string"
		},
		{
			"key": "productId",
			"value": "",
			"type": "string"
		}
	]
}